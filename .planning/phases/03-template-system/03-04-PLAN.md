---
phase: 03-template-system
plan: 04
type: execute
wave: 3
depends_on: ["03-02", "03-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can create template with multiple items"
    - "User can edit existing template"
    - "User can delete template"
    - "User can view template library"
    - "User can select multiple templates and create merged checklist"
    - "Merged checklist shows items grouped by template source"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete template system works end-to-end through human testing of all template management and checklist instantiation workflows.

Purpose: Confirm all requirements (TMPL-01 through TMPL-04, INST-01 through INST-03) are met and the system delivers the core value of fast, frictionless checklist instantiation
Output: Human-validated template system ready for production use
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-template-system/03-template-system-CONTEXT.md

# Prior plans in this phase
@.planning/phases/03-template-system/03-01-SUMMARY.md
@.planning/phases/03-template-system/03-02-SUMMARY.md
@.planning/phases/03-template-system/03-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete template system with:
- Database models for templates and checklists
- Template CRUD API endpoints with authentication
- Template library UI (list, create, edit, delete)
- Checklist instantiation API with merge logic
- Template selection UI for creating merged checklists
  </what-built>
  <how-to-verify>
Test the complete template and instantiation workflow:

**1. Template Creation (TMPL-01)**
- Visit http://localhost:3000/templates
- Click "Create New Template"
- Enter name "Morning Routine"
- Add items using Enter key: "Wake up at 6am", "Exercise", "Shower", "Breakfast"
- Add one more item using the button: "Review daily goals"
- Save template
- Verify redirect to template library
- Confirm "Morning Routine" appears in list

**2. Template Creation - Second Template**
- Create another template "Work Setup"
- Add items: "Review email", "Check calendar", "Exercise", "Plan top 3 priorities"
- Note: "Exercise" is duplicate (will test deduplication)
- Save template

**3. Template Creation - Third Template**
- Create template "Evening Wind Down"
- Add items: "Review email", "Journal", "Plan tomorrow", "Read"
- Note: "Review email" is duplicate
- Save template

**4. Template Library View (TMPL-04)**
- Verify all three templates appear in library
- Check that item counts are correct (5, 4, and 4 items)
- Verify templates are sorted or displayed in a consistent order

**5. Template Editing (TMPL-02)**
- Click Edit on "Morning Routine"
- Change name to "Morning Routine v2"
- Add new item: "Meditate"
- Remove item: "Review daily goals"
- Reorder: move "Exercise" to top position
- Save changes
- Verify changes persist when viewing template library

**6. Checklist Instantiation - Single Template (INST-01, INST-02, INST-03)**
- Visit http://localhost:3000/checklists/new
- Select only "Morning Routine v2" template
- Enter checklist name: "Monday Morning"
- Create checklist
- Verify success (redirect or success message)

**7. Checklist Instantiation - Multiple Templates with Deduplication**
- Visit /checklists/new
- Select templates IN ORDER: "Morning Routine v2", "Work Setup", "Evening Wind Down"
- Enter checklist name: "Full Day Workflow"
- Create checklist
- Verify items appear in correct order:
  - Group 1 (Morning Routine v2): Exercise, Wake up at 6am, Shower, Breakfast, Meditate
  - Group 2 (Work Setup): Review email, Check calendar, Plan top 3 priorities (Exercise skipped - duplicate)
  - Group 3 (Evening Wind Down): Journal, Plan tomorrow, Read (Review email skipped - duplicate)
- Verify each item shows its source template name
- Confirm duplicates only appear once

**8. Template Deletion (TMPL-03)**
- Return to template library
- Delete "Evening Wind Down" template
- Confirm deletion prompt appears
- Confirm deletion
- Verify template is removed from library

**9. Keyboard Accessibility**
- Create new template
- Test that Enter key adds items (keyboard-driven workflow)
- Test that "Add Item" button also works (mouse-driven workflow)
- Confirm both methods work as specified in requirements

**10. Empty States**
- Test /templates when no templates exist (create new user or delete all)
- Verify appropriate empty state message
- Test /checklists/new when no templates exist
- Verify message with link to create templates

**Expected Behaviors:**
- All pages require authentication (redirect to /login if not authenticated)
- Template library shows only user's templates (data isolation)
- Item reordering mechanism works smoothly
- Both Enter key and button work for adding items
- Merge logic preserves template selection order
- Deduplication removes exact text matches (first occurrence wins)
- Template source is visible for each merged item
- UI is responsive and styled consistently with existing pages

**Issues to Check For:**
- Can create template with zero items (should be prevented)
- Can create checklist with zero templates selected (should be prevented)
- User can access other users' templates (should be prevented)
- Items lose order after editing (order should persist)
- Deduplication case sensitivity (should be exact match, case-sensitive)
  </how-to-verify>
  <resume-signal>
Type "approved" if all tests pass and system works as expected.

If issues found, describe the specific problem(s) - I'll create a gap closure plan to fix them.
  </resume-signal>
</task>

</tasks>

<verification>
Human testing confirms:
- Template creation works with keyboard and mouse input
- Template editing preserves and updates all fields correctly
- Template deletion removes data from database
- Template library displays all user templates
- Checklist instantiation merges templates in selection order
- Deduplication works correctly (first occurrence wins)
- Template source is visible in merged checklist
- Empty states display appropriate messages
- Authentication and user isolation work correctly
- UI is responsive and consistent with existing design
</verification>

<success_criteria>
All Phase 3 requirements validated by human:
- TMPL-01: User can create new template with checklist items ✓
- TMPL-02: User can edit existing template (add, remove, reorder items) ✓
- TMPL-03: User can delete template from library ✓
- TMPL-04: User can view template library (list of all templates) ✓
- INST-01: User can select multiple templates to combine ✓
- INST-02: User can name the new checklist ✓
- INST-03: User can create checklist from selected templates (merges all items) ✓

Phase 3 success criteria from ROADMAP.md:
1. User can create template with multiple checklist items ✓
2. User can edit existing template (add, remove, reorder items) ✓
3. User can delete template from library ✓
4. User can view all templates in their library ✓
5. User can select multiple templates and create merged checklist ✓
6. Merged checklist contains all items from selected templates ✓

System is ready for Phase 4 (Checklist Workflow).
</success_criteria>

<output>
After completion, create `.planning/phases/03-template-system/03-04-SUMMARY.md`
</output>
