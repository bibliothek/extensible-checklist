---
phase: 02-authentication
plan: 04
type: execute
wave: 3
depends_on: ["02-02", "02-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can complete full signup flow end-to-end"
    - "User can complete full login flow end-to-end"
    - "User can logout successfully from authenticated state"
    - "Sessions persist across browser refresh"
    - "Invalid credentials are rejected with clear errors"
    - "Each user's data isolated (userId available in session)"
  artifacts:
    - path: "app/signup/page.tsx"
      provides: "Signup flow verified by human testing"
      min_lines: 40
    - path: "app/login/page.tsx"
      provides: "Login flow verified by human testing"
      min_lines: 40
    - path: "app/components/LogoutButton.tsx"
      provides: "Logout functionality verified by human testing"
      exports: ["default"]
  key_links:
    - from: "signup/login forms"
      to: "Auth.js authentication"
      via: "end-to-end user flows work correctly"
      pattern: ".*"
    - from: "Auth.js session"
      to: "database persistence"
      via: "sessions survive browser refresh"
      pattern: ".*"
---

<objective>
Verify complete authentication system works correctly through human testing.

Purpose: Confirm all authentication flows (signup, login, logout) function correctly, sessions persist as configured (30 days, sliding window), errors display appropriately, and Phase 2 requirements (AUTH-01, AUTH-02, AUTH-03) are satisfied.

Output: Human-confirmed working authentication system ready for Phase 3 (Template System) to build upon.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-authentication/02-CONTEXT.md

# Completed auth implementation
@.planning/phases/02-authentication/02-01-SUMMARY.md
@.planning/phases/02-authentication/02-02-SUMMARY.md
@.planning/phases/02-authentication/02-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete authentication system with signup, login, and logout flows. Database-backed sessions with 30-day expiry and sliding window. Email/password credentials authentication via Auth.js with bcrypt password hashing. Error handling for invalid credentials and duplicate emails.
  </what-built>
  <how-to-verify>
Test the complete authentication system end-to-end:

**1. Signup Flow (AUTH-01):**
   - Visit http://localhost:3000
   - Click "Sign Up" link to /signup
   - Enter email: test@example.com, password: testpass123 (min 8 chars)
   - Submit form
   - Expected: Redirects to authenticated area (landing page), user is logged in
   - Verify: Check Prisma Studio (npm run db:studio) - User record exists with hashed password

**2. Duplicate Email Handling:**
   - Log out if still authenticated
   - Visit /signup again
   - Try to create account with same email: test@example.com
   - Expected: Error message "Email already registered - try logging in instead"

**3. Login Flow (AUTH-02):**
   - Visit http://localhost:3000/login
   - Enter email: test@example.com, password: wrongpassword
   - Expected: Error message "Invalid email or password"
   - Enter correct password: testpass123
   - Submit form
   - Expected: Redirects to authenticated area, user is logged in

**4. Session Persistence:**
   - While logged in, refresh browser (Ctrl+R / Cmd+R)
   - Expected: Still authenticated, no redirect to login
   - Check DevTools > Application > Cookies
   - Expected: Session cookie present with appropriate expiry (~30 days)

**5. Logout Flow (AUTH-03):**
   - Click logout button
   - Expected: Redirects to landing page, user is logged out
   - Check DevTools > Application > Cookies
   - Expected: Session cookie cleared or invalidated

**6. Verify Isolation:**
   - Check Prisma Studio - confirm User has unique id
   - Expected: userId available in session for future data isolation
   - Open browser DevTools console, run: `fetch('/api/auth/session').then(r => r.json()).then(console.log)`
   - Expected: Session object includes user with id

**7. UI/UX Check:**
   - Forms styled consistently with Tailwind CSS
   - Error messages clear and helpful
   - Links between signup/login work correctly
   - Landing page shows appropriate UI (login/signup when logged out, logout when logged in)

**Phase Success Criteria:**
- ✅ User can create account with email and password
- ✅ User can log in and stay logged in across browser sessions
- ✅ User can log out from any page
- ✅ Each user's data is isolated (userId in session)
  </how-to-verify>
  <resume-signal>
Type "approved" if all checks pass and authentication system works correctly.

If issues found, describe them and I'll create gap closure plans to fix.
  </resume-signal>
</task>

</tasks>

<verification>
Human verification confirms:
1. Signup creates user with hashed password ✓
2. Duplicate email shows appropriate error ✓
3. Login authenticates with valid credentials ✓
4. Invalid credentials show error message ✓
5. Sessions persist across browser refresh ✓
6. Logout clears session and redirects ✓
7. User isolation ready (userId in session) ✓
8. UI/UX acceptable for v1 ✓
</verification>

<success_criteria>
Phase 2 complete when:
- All authentication flows verified by human testing
- Requirements AUTH-01, AUTH-02, AUTH-03 satisfied
- Session management works per CONTEXT.md specifications (30 days, sliding window)
- No blocking issues preventing Phase 3 (Template System)
- User confirms readiness to proceed
</success_criteria>

<output>
After completion, create `.planning/phases/02-authentication/02-04-SUMMARY.md`
</output>
