---
phase: 12-navigation-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["12-01"]
files_modified:
  - app/layout.tsx
  - app/page.tsx
autonomous: true

must_haves:
  truths:
    - "Navigation bar appears at top of Templates page"
    - "Navigation bar appears at top of Checklists page"
    - "Navigation bar appears at top of Dashboard page"
    - "Authenticated user logging in lands on /dashboard instead of home page"
    - "Unauthenticated user can still access home page"
  artifacts:
    - path: "app/layout.tsx"
      provides: "Root layout with Navigation component integrated"
      contains: "Navigation"
      min_lines: 40
    - path: "app/page.tsx"
      provides: "Home page with auth-based redirect to dashboard"
      contains: "useSession|/dashboard"
      min_lines: 30
  key_links:
    - from: "app/layout.tsx"
      to: "app/components/Navigation"
      via: "import and render in SessionProvider wrapper"
      pattern: "import.*Navigation|<Navigation"
    - from: "app/page.tsx"
      to: "/dashboard"
      via: "router.push when authenticated"
      pattern: "push.*dashboard"
    - from: "app/layout.tsx"
      to: "app/page.tsx"
      via: "Layout wraps Home page children"
      pattern: "children"
---

<objective>
Integrate Navigation component into root layout and update home page to redirect authenticated users to dashboard.

Purpose: Navigation persists across all authenticated pages, and authenticated users see dashboard instead of home page, improving navigation flow and UX.

Output:
1. Updated layout.tsx with Navigation component integrated in SessionProvider
2. Updated page.tsx (home) with redirect logic to send authenticated users to /dashboard
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Reference Plan 01 summary for Navigation component details
@.planning/phases/12-navigation-dashboard/12-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate Navigation component into root layout and update home page redirect</name>
  <files>app/layout.tsx, app/page.tsx</files>
  <action>Make two updates:

## Update 1: app/layout.tsx
- Add import: `import Navigation from "./components/Navigation";`
- Wrap the children with Navigation component inside SessionProvider:
  ```
  <SessionProvider>
    <Navigation />
    {children}
  </SessionProvider>
  ```
- Navigation will display on all child pages that render within this layout

## Update 2: app/page.tsx
- Import useSession, useRouter, and useEffect from React and Next.js (already imported)
- In the Home component, add logic that:
  1. Gets session and status from useSession()
  2. On mount (useEffect), if status is "authenticated", redirect to /dashboard using router.push("/dashboard")
  3. If status is "loading", show loading state
  4. If status is "unauthenticated", show normal home page (Keep existing login/signup buttons)
- The redirect should happen before rendering the page content to avoid flash

Structure:
```typescript
useEffect(() => {
  if (status === "authenticated") {
    router.push("/dashboard");
    return;
  }
}, [status, router]);

if (status === "loading") {
  return <main className="...">Loading...</main>;
}

// if unauthenticated, show home page with login/signup buttons
return <main>...</main>;
```
  </action>
  <verify>grep -n "import Navigation" app/layout.tsx && grep -n "<Navigation" app/layout.tsx && grep -n "dashboard" app/page.tsx && grep -n "useEffect" app/page.tsx</verify>
  <done>Layout.tsx imports and renders Navigation component inside SessionProvider. Home page redirects authenticated users to /dashboard on mount. Navigation persists on all authenticated pages. Unauthenticated users still see home page with login/signup options.</done>
</task>

</tasks>

<verification>
After task completion:
1. Navigation component is imported in layout.tsx
2. Navigation renders inside SessionProvider (before children)
3. Home page has useEffect that calls router.push("/dashboard") when authenticated
4. Home page shows loading state while status is loading
5. Home page shows login/signup buttons when unauthenticated
6. TypeScript compiles without errors
7. Navigation appears on /templates page
8. Navigation appears on /checklists page
9. Navigation appears on /dashboard page
10. Authenticated user on home page is redirected to /dashboard
</verification>

<success_criteria>
- [ ] Navigation component integrated into app/layout.tsx
- [ ] Navigation renders inside SessionProvider before children
- [ ] app/page.tsx has useEffect that redirects authenticated users to /dashboard
- [ ] Home page shows appropriate state for loading/authenticated/unauthenticated users
- [ ] Navigation persists on all authenticated pages
- [ ] No TypeScript errors
- [ ] No duplicate layout structures (Navigation should appear once via layout, not per page)
</success_criteria>

<output>
After completion, create `.planning/phases/12-navigation-dashboard/12-02-SUMMARY.md`
</output>
